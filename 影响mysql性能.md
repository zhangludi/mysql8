# 影响数据库性能


## 超高QPS(每秒处理的查询量)和TPS

**风险:**

	效率低下的sql
	
	mysql不支持多个cpu并发
	

## 大量并发和超高的cpu使用效率

**风险**

	大量的并发量,数据库连接被占满(max_connections默认为100)
	
	超高的cpu使用率,cpu资源耗尽出现宕机
	
## 磁盘IO

**风险**

	磁盘IO性能突然下降(使用更快的磁盘)
	
	其他大量消耗磁盘性能的计划任务(调整计划)
	
## 网络流量

**风险**

	网卡IO被占满
	
### 网卡IO被占满如何避免

	减少从服务器的数量
	
	进行分级缓存
	
	避免使用select *
	
	分离业务网络和服务器网络

## 大表带来的问题

	大表的定义
	
	记录行数巨大,超过千万行
	
	表数据文件巨大,超过10G

**问题**

### 慢查询

	对查询影响,慢查询很难在一定时间内过滤出行需要的数据
	
	DDL影响
	
		1.建立索引需要很长时间,风险:mysql>5.5虽然不会锁表,但是会引起主从延迟
		
		2.修改表结构需要很长时间
		
		3.影响正常数据操作
		
**如何处理数据**

#### 分库表把一张大表分成多个小表

	难点:分表主键的选择
	
	分区后跨分区数据的查询和统计
	
#### 大表的历史数据归档

	减少对前端的数据的影响
	
	难点:归档时间点的选择
	
	如何进行归档操作
	
## 大事务带来的问题

### 大事务
		
		1. 事务是数据库系统区别于其他一切文件系统的重要特征之一
		
		2.事务是一组具有原子性的sql语句或是一个独立的工作单元
		
		3.事务的ACID
		

		4.运行时间较长,操作数据比较多的事务
		

**风险**

		1.锁定太多的数据,造成大量的阻塞和锁超时
		
		2.回滚时所需要的时间比较长
		
		3.执行时间长容易造成主从延迟
		

#### 如何处理大事务


	1.避免一次处理太多的数据
	
	2.移除不必要的事务中select的操作
	
